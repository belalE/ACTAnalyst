<% layout('layouts/boilerplate') %>
<!-- admin section, add resources etc -->
<h1 class="mb-3 text-center">Edit Question Type</h1>
<form action="/types/<%= type._id %>?_method=PUT" method="POST">
  <div class="mb-3">
    <label for="name">Name</label>
    <input
      type="text"
      class="form-control"
      id="name"
      name="questionType[name]"
      value="<%= type.name %> "
    />
  </div>
  <div class="row mb-3">
    <div class="col">
      <select name="questionType[section]" id="section" class="form-select">
        <option value="" disabled>Select section</option>
        <option <% if (type.section == "English") { %> selected <% } %>  value="English">English</option>
        <option <% if (type.section == "Math") { %> selected <% } %>  value="Math">Math</option>
        <option <% if (type.section == "Reading") { %> selected <% } %> value="Reading">Reading</option>
        <option <% if (type.section == "Science") { %> selected <% } %>  value="Science">Science</option>
      </select>
    </div>
    <div class="col">
      <select name="questionType[general]" id="general" class="form-select">
        <option value="" selected disabled>Select general topic</option>
        <% for (let topic of topics[type.section.toLowerCase()]) { %>
        <option <% if (type.general == topic) { %> selected <% } %>value="<%= topic %>"><%= topic %></option>
        <% } %>
      </select>
    </div>
  </div>
  <h2 class="mb-3">Add Resources</h2>
  <div class="mb-3">
    <input
      type="number"
      class="form-control"
      min="0"
      step="1"
      id="resourceCount"
      value=<%= type.resources.length %>
    />
  </div>
  <div class="mb-3" id="resourcesDiv">
      <% for (let i=0;i<type.resources.length;i++) { %> 
        <div class='form-group resourceInput'>
    <label for="resource<%= i %>Name">Name</label>
    <input type="text" id="resource<%= i %>Name" name="questionType[resources][<%= i %>][name]" class="form-control mb-3" value="<%= type.resources[i].name %>">
    <label for="resource<%= i %>Link">Link</label>
    <input type="text" id="resource<%= i %>Link" name="questionType[resources][<%= i %>][link]" class="form-control mb-3" value="<%= type.resources[i].link %>">
    <label for="resource<%= i %>Description">Description</label>
    <input type="text" id="resource<%= i %>Description" name="questionType[resources][<%= i %>][description]" class="form-control mb-3" value="<%= type.resources[i].description %>">
    <select name="questionType[resources][<%= i %>][format]" id="resource<%= i %>Format" class="form-select">
        <option value="" disabled>Select section</option>
        <option <% if (type.resources[i].format == "Video") { %> selected <% } %> value="Video">Video</option>
        <option <% if (type.resources[i].format == "Article") { %> selected <% } %> value="Article">Article</option>
        <option <% if (type.resources[i].format == "Text") { %> selected <% } %> value="Text">Text</option>
        <option <% if (type.resources[i].format == "Formula") { %> selected <% } %> value="Formula">Formula</option>
      </select>
      <hr/>
      </div>
        <% } %> 
  </div>
  <button type="submit" class="btn btn-success">Edit</button>
</form>

<script>
  const topics = <%- JSON.stringify(topics) %>
</script>
<script src="/javascripts/topicSelector.js"></script>
<script src="/javascripts/resources.js"></script>